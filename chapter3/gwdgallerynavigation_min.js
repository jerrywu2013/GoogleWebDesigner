(function(){"use strict";var f=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},g=function(a){if(f(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&f(a))return a;return null};document.registerElement&&(window.g=document.registerElement("gwd-gallerynavigation",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.a=null;this.f=this.onGalleryReady_.bind(this);this.e=this.onGalleryFrameActivated_.bind(this);this.d=!1;this.b=document.createElement("div");this.b.classList.add("button-container");this.appendChild(this.b);this.b.addEventListener("click",this.onButtonContainerClicked_.bind(this),!0);this.c=[]},enumerable:!0},getElementByIdOrPseudoId_:{value:function(a){for(var b=
document.getElementById(a),c=!1,d=this.parentNode;!b&&d&&!c;d=d.parentNode)if((c="body"==d.tagName.toLowerCase())||d.hasAttribute("data-gwd-group"))b=d.querySelector('[data-gwd-grp-id="'+a+'"]');return b}},updateBinding_:{value:function(){this.clearGalleryHandlers_();var a=this.getAttribute("for"),b=null;a&&(b=this.getElementByIdOrPseudoId_(a));t:if(b){for(var a="currentIndex frameCount frameSnapInterval getFrame goToFrame goForwards goBackwards rotateOnce".split(" "),c=0;c<a.length;++c)if(!(a[c]in
b)){a=!1;break t}a=!0}else a=!1;a&&(this.a=b,b.addEventListener("frameactivated",this.e),b.gwdIsLoaded()?this.updateButtons_():b.addEventListener("ready",this.f))}},clearGalleryHandlers_:{value:function(){this.a&&(this.a.removeEventListener("ready",this.f),this.a.removeEventListener("frameactivated",this.e))}},onGalleryReady_:{value:function(a){a.target==this.a&&this.updateButtons_()}},onGalleryFrameActivated_:{value:function(a){a.target==this.a&&this.updateActiveButtons_(a.detail.id)}},onButtonContainerClicked_:{value:function(a){for(a=
a.target;a&&a!=this;a=a.parentNode)if(a.gwdTargetFrameNum){this.a.goToFrame(a.gwdTargetFrameNum);break}}},updateButtons_:{value:function(){var a=this.getAttribute("highlight");this.style.color=a||"";this.d=this.hasAttribute("use-thumbnails");for(this.c=[];this.b.firstChild;)this.b.removeChild(this.b.firstChild);if(this.a){for(a=0;a<this.a.frameCount;a+=this.a.frameSnapInterval){var b=document.createElement("span");b.classList.add("button");for(var c=this.d?this.a.frameSnapInterval:1,d=0;d<c;++d){var e=
this.a.getFrame(a+d+1);if(!e)break;e=this.createFrameVisual_(e);b.appendChild(e)}b.gwdTargetFrameNum=a+1;this.c.push(b);this.b.appendChild(b)}this.updateActiveButtons_()}}},createFrameVisual_:{value:function(a){var b=document.createElement("span");if(this.d){b.classList.add("frame-thumbnail");var c;("img"==a.tagName.toLowerCase()&&"gwd-image"==a.getAttribute("is")?a:a.querySelector("img[is=gwd-image]"))&&(c=a.getAttribute("source"));b.style.backgroundImage=c?"url("+JSON.stringify(c)+")":"url(data:image/gif;base64,R0lGODlhAQABAPAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==)"}else b.classList.add("frame-dot");
return b}},updateActiveButtons_:{value:function(a){a=void 0!=a?a-1:this.a.currentIndex-1;a=Math.floor(a/this.a.frameSnapInterval);for(var b=0;b<this.c.length;b++)this.c[b].classList.remove("active");(a=this.c[a])&&a.classList.add("active")}},attachedCallback:{value:function(){this.updateBinding_();if("function"==typeof this.gwdLoad){var a=g(this),b="function"==typeof this.gwdIsLoaded,c=a&&"function"==typeof a.gwdIsLoaded;if(!a||c&&a.gwdIsLoaded())b&&this.gwdIsLoaded()||this.gwdLoad()}},enumerable:!0},
detachedCallback:{value:function(){this.clearGalleryHandlers_()},enumerable:!0},attributeChangedCallback:{value:function(a){"for"==a?this.updateBinding_():this.updateButtons_()},enumerable:!0}})}));})()
